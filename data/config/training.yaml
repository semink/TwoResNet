# This NONPARAMS sections are not recorded as hyperparameters in tensorboard!
NONPARAMS:
  LOG:
    save_dir: experiments
    log_graph: True
    name: TwoResNet

  SUMMARY:
    max_depth: 2

  TRAINER:
    accelerator: gpu
    devices: [0] 
    max_epochs: 50

  DATA:
    num_workers: 16

  METRIC:
    monitor_metric_name: 'validation'
    training_metric_name: 'training'
    loss_metric: 'mae'

  EARLY_STOPPING:
    divergence_threshold: 2.8
    monitor: 'validation/mae'

# This HPARAMS sections are recorded as hyperparameters in tensorboard!
HPARAMS:
  DATA:
    batch_size: 32
    adj_info:
      sparcity:
        corr: 0.9015075698183189
        prox: 0.8235293538393196
      alpha: 0.4556550085278627
    cluster_info:
      K: 5
    dow: true
    horizon: 12
    seq_len: 12
    time_feat_mode: sinusoidal
  
  HIGH_RES_NET:
    dropout: 0
    gcn_order: 2
    num_RU: 2
    hid_feat: 64
    out_feat: 1
  
  LOW_RES_NET:
    dropout: 0
    num_RU: 1
    hid_feat: 64
    out_feat: 1
  
  OPTIMIZER:
    adam:
      eps: 0.001
      lr: 0.01
      
    low_resol_loss_weight: 1
    multisteplr:
      gamma: 0.1
      reduce_step_factor: 2
  
  TEACHER_FORCING:
    half_life_epoch: 13.33
    high_resolution_model: on
    low_resolution_model: off
    milestone_start_p: 0.03
    slope_at_half: -0.1425525
  
  TRAINER:
    gradient_clip_val: 5